# Assignment 2 Group 22
## Julia Liu, Pranay Jagtap, Evan Lam, Andrew Wingersky

The purpose of this project is to develop a REST API that, when provided JSON keypoints generated by posenet, can classify those signs as one of the following: BUY, COMMUNICATE, FUN, HOPE, MOTHER, and REALLY. These python scripts were used to develop the models using the training data provided and give a way to access those models when given keypoints json. The first step of creating these models is through data preprocessing.

## Data Preprocessing
The first step in data preprocessing is to run ```addNoseDist.py``` on the directories containing the keypoints csv files. This will require modifying the paths that the function defined in the script takes in as a parameter within the script itself. The purpose of the script is to create an additional four columns to the data for the x and y coordinates of the left and right wrist and their relative distance to the x and y coordinates of the nose location.
Preprocessing step also performs feature selection and discards features which do not provide relevant information required for classification. The gestures stated above dont have any movements from parts like knees and such features are discarded. 
```
pythonNoseDist.py
```
The second step in data preprocessing is to run ```MCDriver.py``` on the directory of data. In order to run this script, the data must be in a very specific directory format (the same as was given in class). Within one directory, all csv files must be separated by sign into different subdirectories whose name is of that sign. For example:
```
CSV                               #This is the directory path that you provide
├── buy                           #subdirectory for sign "buy"
│   ├── BUY_PRACTICE_1...csv      #within the buy directory contains all of the csv files for buy
│   ├── BUY_PRACTICE_2...csv      
│   └── ... 
├── communicate             
│   ├── COMMUNCIATE_PRAC...csv     
│   └── ... 
├── fun                 
│   ├── ...
├── hope                  
│   ├── ...
└── ...
```
Before running this script, it is important to also separate the testing data from the training data. This testing data must also be organized in the same directory format. 
Training data is passed to all the models for training the four classifiers while test data separated initially is used for evaluating these models.

## Flask server
The service is hosted using a python Flask server. The exposed API takes in a JSON request which are keypoints data for all the frames in a video and the service responds with a JSON response with predictions by all the 4 models for the request.
```
main.py
```
The request is intercepted by flask server script and is passed onto the preprocessing function which parses the JSON request and creates a dataframe containg the required fields and also the calculated fields (Considering distances of features from nose taken as origin). This data is then passed on to the the function which predicts these frames using 4 models and aggregates these frames results to generate a single classification for the video. This is wrapped as a JSON response and the server sends this response back to the caller of the service.

## Models
Below are the four models used for classification
1. KNN 
2. SVM
3. Decision Tree
4. Random Forest

All the models are placed into the below file
```
models.py
```
In order to train the model we call runKNN,runSVM,runnDT and runRF. These trained models are stored as .pkl file. In order to predict, the system loads the models from the previously stored pickle file and uses this for the prediction.
The pickle files generated are as below
```
knn_classifier.pkl
svm_classifier.pkl
dt_classifier.pkl
rf_classifier.pkl
```

## Submission details

1. The script containing functions that train the 4  models (models.py) is stored in the notebood directory.
2. The models i.e the pickle files which is used for prediction is stored in the models directory.
3. The server script which is used to intercept requests coming from all the API calls is stored in the src directory
 
